<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Rechnung {{invoice.number}}</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Bebas+Neue&display=swap');
    
    @page {
      size: A4;
      margin: 25mm 15mm 15mm 15mm;
      
      @top-center {
        content: "";
      }
      
      @bottom-center {
        content: "";
      }
      
      @bottom-right {
        content: "";
      }
    }
    
    @media print {
      .no-print { display: none !important; }
      
      body {
        margin: 0;
        padding: 0;
        width: 210mm;
      }
      
      .container {
        margin: 0;
        padding: 0;
        box-shadow: none;
        width: 210mm !important;
        max-width: 210mm !important;
        min-height: 297mm;
      }
      
      .footer {
        position: fixed !important;
        bottom: 5mm !important;
        left: 15mm !important;
        right: 15mm !important;
        width: calc(210mm - 30mm) !important;
        margin: 0 !important;
        padding: 8pt 0 !important;
        border-top: 1pt solid #ddd !important;
        background: white !important;
        z-index: 1000 !important;
      }
      
      .footer-content {
        display: flex !important;
        justify-content: space-between !important;
        align-items: flex-start !important;
        flex-wrap: wrap !important;
        gap: 15pt !important;
        max-width: 100% !important;
      }
      
      .footer-section {
        flex: 1 !important;
        min-width: 120pt !important;
        max-width: 33% !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
      }
      
      .content-wrapper {
        padding: 0mm 0 5mm 0 !important;
        margin: 0 !important;
        position: relative;
        z-index: 1;
      }
      
      table {
        page-break-inside: avoid;
      }
      
      tr {
        page-break-inside: avoid;
      }
      
      .items-table thead {
        display: table-header-group;
      }
      
      .items-table tbody tr {
        page-break-inside: avoid;
        page-break-after: auto;
      }
      
      .totals-section {
        page-break-inside: avoid;
        page-break-before: auto;
      }
      
      .payment-terms {
        page-break-inside: avoid;
        page-break-before: auto;
      }
      
      .notes {
        page-break-inside: avoid;
        page-break-before: auto;
      }
      
      .page-break {
        page-break-before: always;
      }
      
      .page-break-avoid {
        page-break-inside: avoid;
      }
      
      /* Ensure header and footer appear on every page */
      .order-confirmation-page .header {
        display: none; /* Hide duplicate header on order confirmation page */
      }
      
      /* Ensure recipient section is positioned correctly in PDF */
      .recipient-section {
        margin-top: 0pt !important;
        margin-bottom: 25pt !important;
      }
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      font-size: 11pt;
      line-height: 1.5;
      color: #1A1A1A;
      margin: 0;
      padding: 0;
      background: white;
    }
    
    .container {
      width: 100%;
      max-width: 210mm;
      margin: 0 auto;
      background: white;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 10pt;
      line-height: 1.4;
      color: #333;
    }
    
    .content-wrapper {
      padding: 0;
      margin: 0;
      position: relative;
      z-index: 1;
    }
    
    /* Header */
    .header {
      background-color: #C53030;
      color: white;
      padding: 15pt calc(15mm + 15pt) 15pt calc(15mm + 15pt);
      margin: 0 -15mm 20pt -15mm;
      width: calc(100% + 30mm);
      box-sizing: border-box;
      z-index: 10;
      display: flex;
      justify-content: space-between;
      align-items: center;
      overflow: hidden;
      min-height: 60pt;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
      position: relative;
    }
    
    .header::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 100pt;
      height: 100%;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M20,20 Q50,5 80,20 Q50,35 20,20" fill="%23ffffff" opacity="0.1"/></svg>') no-repeat center;
      background-size: contain;
    }
    
    .logo-section {
      flex: 0 0 auto;
      z-index: 2;
    }
    
    .logo {
      max-width: 120pt;
      max-height: 60pt;
      object-fit: contain;
    }
    
    .brand-name {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 24pt;
      font-weight: 400;
      letter-spacing: 1pt;
      margin: 0;
    }
    
    .brand-tagline {
      font-size: 9pt;
      opacity: 0.9;
      margin: 2pt 0 0 0;
      font-weight: 400;
    }
    
    .issuer-section {
      flex: 0 0 auto;
      text-align: right;
      font-size: 9pt;
      line-height: 1.4;
      z-index: 2;
    }
    
    .issuer-name {
      font-size: 13pt;
      font-weight: 600;
      margin-bottom: 6pt;
    }
    
    .issuer-address {
      margin-bottom: 6pt;
      opacity: 0.95;
    }
    
    .issuer-contact {
      font-size: 8pt;
      opacity: 0.9;
    }
    
    /* Recipient (DIN 5008 konform) */
    .recipient-section {
      margin-bottom: 25pt;
      margin-top: 0pt;
    }
    
    .recipient {
      background: white;
      border: 1pt solid #ddd;
      border-left: 4pt solid #C04020;
      border-radius: 0 8pt 8pt 0;
      padding: 15pt 20pt;
      font-size: 11pt;
      line-height: 1.4;
      box-shadow: 0 2pt 8px rgba(192, 64, 32, 0.1);
    }
    
    .recipient-name {
      font-weight: 700;
      font-size: 12pt;
      color: #C04020;
      margin-bottom: 6pt;
    }
    
    /* Metadata */
    .metadata {
      margin-bottom: 25pt;
      background: #f8f9fa;
      border-radius: 12pt;
      padding: 20pt;
      border: 1pt solid #ddd;
    }
    
    .metadata-table {
      width: 100%;
      font-size: 10pt;
      border-collapse: collapse;
    }
    
    .metadata-table td {
      padding: 6pt 12pt;
      vertical-align: top;
    }
    
    .metadata-table .label {
      font-weight: 600;
      color: #666;
      width: 25%;
    }
    
    .metadata-table .value {
      width: 25%;
      font-weight: 500;
      color: #1A1A1A;
    }
    
    /* Invoice Title */
    .invoice-title {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 28pt;
      font-weight: 400;
      letter-spacing: 2pt;
      margin: 25pt 0 20pt 0;
      color: #C04020;
      text-transform: uppercase;
      position: relative;
      padding-bottom: 8pt;
    }
    
    .invoice-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60pt;
      height: 3pt;
      background: #C04020;
      border-radius: 2pt;
    }
    
    /* Items Table */
    .items-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20pt 0;
      font-size: 9pt;
    }
    
    .items-table th {
      background: #f5f5f5;
      color: #333;
      font-weight: 600;
      padding: 8pt 6pt;
      text-align: left;
      border: 1pt solid #ccc;
      font-size: 8pt;
    }
    
    .items-table td {
      padding: 6pt;
      border: 1pt solid #ccc;
      vertical-align: top;
      font-size: 8pt;
    }
    
    .items-table .pos {
      width: 8%;
      text-align: center;
    }
    
    .items-table .description {
      width: 40%;
    }
    
    .items-table .category {
      width: 20%;
      text-align: center;
    }
    
    .items-table .quantity {
      width: 15%;
      text-align: right;
    }
    
    .items-table .unit-price {
      width: 12%;
      text-align: right;
    }
    
    .items-table .total {
      width: 13%;
      text-align: right;
      font-weight: 600;
    }
    
    .items-table .number {
      font-family: 'Courier New', monospace;
    }
    
    /* Totals */
    .totals-section {
      display: flex;
      justify-content: flex-end;
      margin-top: 25pt;
      margin-bottom: 30pt;
    }
    
    .totals {
      width: 280pt;
      border-radius: 12pt;
      overflow: hidden;
      box-shadow: 0 6pt 20pt rgba(192, 64, 32, 0.15);
      border: 1pt solid #ddd;
    }
    
    .totals-header {
      background: linear-gradient(135deg, #C04020 0%, #A03318 100%);
      color: white;
      padding: 15pt 20pt;
      font-weight: 700;
      font-size: 12pt;
      text-transform: uppercase;
      letter-spacing: 1pt;
      position: relative;
    }
    
    .totals-header::after {
      content: '🔥';
      position: absolute;
      right: 20pt;
      top: 50%;
      transform: translateY(-50%);
      font-size: 16pt;
    }
    
    .totals-body {
      padding: 20pt;
      background: white;
    }
    
    .totals-table {
      width: 100%;
      font-size: 10pt;
    }
    
    .totals-table td {
      padding: 6pt 0;
    }
    
    .totals-table .label {
      text-align: left;
      font-weight: 500;
      color: #666;
    }
    
    .totals-table .amount {
      text-align: right;
      font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
      font-weight: 600;
      color: #1A1A1A;
    }
    
    .totals-table .total-row {
      border-top: 2pt solid #C04020;
      padding-top: 10pt;
      font-weight: 700;
      font-size: 13pt;
    }
    
    .totals-table .total-row td {
      padding-top: 10pt;
    }
    
    .totals-table .total-row .label {
      color: #C04020;
    }
    
    .totals-table .total-row .amount {
      color: #C04020;
      font-size: 14pt;
    }
    
    /* Payment Terms */
    .payment-terms {
      margin-bottom: 25pt;
      padding: 20pt;
      background: #f8f9fa;
      border: 1pt solid #ddd;
      border-left: 4pt solid #C04020;
      border-radius: 8pt;
      font-size: 10pt;
      box-shadow: 0 2pt 8pt rgba(192, 64, 32, 0.08);
    }
    
    .payment-terms h3 {
      margin: 0 0 10pt 0;
      font-size: 12pt;
      font-weight: 700;
      color: #C04020;
      display: flex;
      align-items: center;
    }
    
    .payment-terms h3::before {
      content: '💳';
      margin-right: 8pt;
      font-size: 14pt;
    }
    
    /* Order Confirmation Page */
    .order-confirmation-page {
      padding: 15mm 15mm;
    }
    
    .page-title {
      text-align: center;
      font-size: 22pt;
      font-weight: 700;
      color: #C04020;
      margin-bottom: 20pt;
      text-transform: uppercase;
      letter-spacing: 1pt;
    }
    
    /* Order Confirmation */
    .order-confirmation {
      margin-bottom: 25pt;
      padding: 18pt;
      background: #f8f9fa;
      border: 1pt solid #ddd;
      border-left: 4pt solid #C04020;
      border-radius: 6pt;
      font-size: 10pt;
      line-height: 1.4;
      box-shadow: 0 2pt 6pt rgba(192, 64, 32, 0.08);
    }
    
    .order-confirmation h3 {
      margin: 0 0 12pt 0;
      font-size: 12pt;
      font-weight: 700;
      color: #C04020;
      display: flex;
      align-items: center;
    }
    
    .order-confirmation h3::before {
      content: '📋';
      margin-right: 8pt;
      font-size: 14pt;
    }
    
    .confirmation-text {
      margin-bottom: 18pt;
      line-height: 1.5;
      text-align: justify;
    }
    
    .signature-fields {
      display: flex;
      justify-content: space-between;
      margin-top: 25pt;
    }
    
    .signature-field {
      width: 45%;
      border-bottom: 1pt solid #333;
      padding-bottom: 3pt;
      text-align: center;
      font-size: 9pt;
      color: #666;
      min-height: 25pt;
    }
    
    /* Delivery Address */
    .delivery-address {
      margin-bottom: 25pt;
      padding: 18pt;
      background: #f8f9fa;
      border: 1pt solid #ddd;
      border-left: 4pt solid #C04020;
      border-radius: 6pt;
      font-size: 10pt;
      line-height: 1.4;
      box-shadow: 0 2pt 6pt rgba(192, 64, 32, 0.08);
    }
    
    .delivery-address h3 {
      margin: 0 0 12pt 0;
      font-size: 12pt;
      font-weight: 700;
      color: #C04020;
      display: flex;
      align-items: center;
    }
    
    .delivery-address h3::before {
      content: '🚚';
      margin-right: 8pt;
      font-size: 14pt;
    }
    
    .delivery-zone {
      margin-top: 12pt;
      padding: 12pt;
      background: #fff;
      border: 1pt solid #ddd;
      border-radius: 4pt;
      min-height: 60pt;
      font-size: 11pt;
      line-height: 1.4;
    }
    
    .confirmation-statement {
      margin-top: 18pt;
      padding: 15pt;
      background: #fff;
      border: 1pt solid #ddd;
      border-radius: 4pt;
      text-align: center;
      font-weight: 600;
      font-size: 10pt;
      line-height: 1.3;
    }
    
    .final-signature {
      margin-top: 25pt;
      border-bottom: 1pt solid #333;
      padding-bottom: 3pt;
      text-align: center;
      font-size: 9pt;
      color: #666;
      width: 60%;
      margin-left: auto;
      margin-right: auto;
      min-height: 25pt;
    }
    
    /* Notes */
    .notes {
      margin-bottom: 30pt;
      padding: 20pt;
      background: #f8f9fa;
      border: 1pt solid #ddd;
      border-left: 4pt solid #C04020;
      border-radius: 8pt;
      font-size: 10pt;
      line-height: 1.6;
      box-shadow: 0 2pt 8pt rgba(192, 64, 32, 0.08);
    }
    
    .notes h3 {
      margin: 0 0 10pt 0;
      font-size: 12pt;
      font-weight: 700;
      color: #C04020;
      display: flex;
      align-items: center;
    }
    
    .notes h3::before {
      content: '📝';
      margin-right: 8pt;
      font-size: 14pt;
    }
    
    /* Footer */
    .footer {
      margin-top: 20pt !important;
      padding: 10pt 20pt !important;
      border-top: 1pt solid #ddd !important;
      font-size: 8pt !important;
      line-height: 1.3 !important;
      color: #666 !important;
      text-align: center !important;
      max-width: 100% !important;
      overflow: hidden !important;
      width: 100% !important;
      box-sizing: border-box !important;
    }
    
    .footer-content {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      flex-wrap: wrap;
      gap: 15pt;
      max-width: 100%;
    }
    
    .footer-section {
      flex: 1;
      min-width: 120pt;
      max-width: 33%;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }
    
    .footer-section.left {
      text-align: left;
    }
    
    .footer-section.center {
      text-align: center;
    }
    
    .footer-section.right {
      text-align: right;
    }
    
    .footer-section strong {
      font-weight: 600;
      color: #333;
      display: block;
      margin-bottom: 2pt;
    }
    
    .footer-section p {
      margin: 0;
      line-height: 1.2;
      word-wrap: break-word;
    }
    
    /* Utilities */
    .text-right {
      text-align: right;
    }
    
    .text-center {
      text-align: center;
    }
    
    .font-mono {
      font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
    }
    
    .text-muted {
      color: #666;
    }
    
    .mb-0 {
      margin-bottom: 0;
    }
    
    .mt-0 {
      margin-top: 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="logo-section">
        {{#if company.logo_url}}
          <img src="{{company.logo_url}}" alt="{{company.name}} Logo" class="logo">
        {{else}}
          <div>
            <h1 class="brand-name">🔥 BRENNHOLZKÖNIG</h1>
            <p class="brand-tagline">Premium Brennholz direkt vom Produzenten</p>
          </div>
        {{/if}}
      </div>
      
      <div class="issuer-section">
        <div class="issuer-name">{{company.name}}</div>
        <div class="issuer-address">
          {{company.address_line1}}<br>
          {{#if company.address_line2}}{{company.address_line2}}<br>{{/if}}
          {{company.postal_code}} {{company.city}}
        </div>
        <div class="issuer-contact">
          {{#if company.phone}}📞 {{company.phone}}<br>{{/if}}
          {{#if company.email}}✉️ {{company.email}}<br>{{/if}}
          {{#if company.website}}🌐 {{company.website}}<br>{{/if}}
          {{#if company.tax_id}}🏢 USt-IdNr.: {{company.tax_id}}{{/if}}
        </div>
      </div>
    </header>
    
    <div class="content-wrapper">
    
    <!-- Recipient (DIN 5008) -->
    <section class="recipient-section">
      <div class="recipient">
        <div class="recipient-name">{{customer.name}}</div>
        {{#if customer.company}}{{customer.company}}<br>{{/if}}
        {{customer.address.street}} {{customer.address.house_number}}<br>
        {{#if customer.address.line2}}{{customer.address.line2}}<br>{{/if}}
        {{customer.address.postal_code}} {{customer.address.city}}
      </div>
    </section>
    
    <!-- Metadata -->
    <section class="metadata">
      <table class="metadata-table">
        <tr>
          <td class="label">Rechnungs-Nr.:</td>
          <td class="value font-mono">{{invoice.number}}</td>
          <td class="label">Kunden-Nr.:</td>
          <td class="value font-mono">{{#if customer.customer_number}}{{customer.customer_number}}{{else}}-{{/if}}</td>
        </tr>
        <tr>
          <td class="label">Rechnungsdatum:</td>
          <td class="value">{{invoice.date}}</td>
          <td class="label">Fällig bis:</td>
          <td class="value">{{invoice.due_date}}</td>
        </tr>
        {{#if order.number}}
        <tr>
          <td class="label">Bestell-Nr.:</td>
          <td class="value font-mono">{{order.number}}</td>
          <td class="label">Bestell-Datum:</td>
          <td class="value">{{order.date}}</td>
        </tr>
        {{/if}}
      </table>
    </section>
    
    <!-- Invoice Title -->
    <h1 class="invoice-title">Rechnung</h1>
    
    <!-- Items Table -->
    <section class="items-section">
      <h3 style="margin: 20pt 0 10pt 0; font-size: 12pt; color: #333;">Auftrag/Lieferschein/Rechnung Nr.:</h3>
      <table class="items-table">
        <thead>
          <tr>
            <th class="description">Produkt</th>
            <th class="category">Kategorie</th>
            <th class="quantity">Menge</th>
            <th class="unit-price">Einzelpreis</th>
            <th class="total">Gesamtpreis</th>
          </tr>
        </thead>
        <tbody>
          {{#each items}}
          {{#if (gt @index 3)}}
          {{#if (eq @index 4)}}
          </tbody>
      </table>
    </section>
    
    <!-- Page Break for Additional Items -->
    <div style="page-break-before: always;"></div>
    
    <!-- Continued Items Table -->
    <section class="items-section">
      <h3 style="margin: 20pt 0 10pt 0; font-size: 12pt; color: #333;">Auftrag/Lieferschein/Rechnung Nr. (Fortsetzung):</h3>
      <table class="items-table">
        <thead>
          <tr>
            <th class="description">Produkt</th>
            <th class="category">Kategorie</th>
            <th class="quantity">Menge</th>
            <th class="unit-price">Einzelpreis</th>
            <th class="total">Gesamtpreis</th>
          </tr>
        </thead>
        <tbody>
          {{/if}}
          {{/if}}
          <tr {{#if (gt @index 3)}}class="continued-item"{{/if}}>
            <td class="description">{{this.name}}</td>
            <td class="category">{{#if this.category}}{{this.category}}{{else}}Brennholz{{/if}}</td>
            <td class="quantity number">{{formatNumber this.quantity}} SRM</td>
            <td class="unit-price number">€{{formatCurrency this.unitPrice}}</td>
            <td class="total number">€{{formatCurrency this.totalPrice}}</td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    </section>
    
    <!-- Totals -->
    <section class="totals-section">
      <div style="float: right; width: 200pt; margin-top: 25pt;">
        <table style="width: 100%; border-collapse: collapse; font-size: 9pt;">
          <tr>
            <td style="padding: 4pt; text-align: left;">Gesamt Netto:</td>
            <td style="padding: 4pt; text-align: right; font-weight: 600;">{{formatCurrency totals.subtotal}}</td>
          </tr>
          <tr>
            <td style="padding: 4pt; text-align: left;">zzgl. {{totals.tax_rate}}% MwSt.:</td>
            <td style="padding: 4pt; text-align: right;">{{formatCurrency totals.tax}}</td>
          </tr>
          <tr style="border-top: 2pt solid #333; font-weight: 600; font-size: 10pt;">
            <td style="padding: 6pt 4pt; text-align: left;">Gesamt Brutto</td>
            <td style="padding: 6pt 4pt; text-align: right;">{{formatCurrency totals.total}}</td>
          </tr>
        </table>
      </div>
      <div style="clear: both; margin-bottom: 15pt;"></div>
    </section>
    
    <!-- Payment Terms -->
    {{#if payment_terms}}
    <section class="payment-terms">
      <h3>Zahlungsbedingungen</h3>
      <p>{{payment_terms}}</p>

    </section>
    {{/if}}
    
    <!-- Notes -->
    {{#if notes}}
    <section class="notes">
      <h3>Hinweise</h3>
      <p>{{notes}}</p>
    </section>
    {{/if}}
    
    <!-- Dynamic Page Break for Order Confirmation -->
    {{#if (gt items.length 4)}}
    <div style="page-break-before: always;"></div>
    {{else}}
    <div style="page-break-before: always;"></div>
    {{/if}}
    
    <!-- Order Confirmation Page -->
    <div class="order-confirmation-page">
      
      <!-- Page Title -->
      <h1 class="page-title">Auftragsbestätigung</h1>
      
      <!-- Order Confirmation -->
      <section class="order-confirmation">
        <h3>Auftragsbestätigung:</h3>
        <div class="confirmation-text">
          Ich erteile / Wir erteilen den Auftrag für die Brennholzlieferung 
          gemäß obigem Angebot. Die AGBs und Lieferbedingung frei 
          Bordsteinkante habe ich gelesen und akzeptiert. Für ausdrücklich 
          gewünschte Lieferungen auf das Grundstück übernimmt der Fahrer und 
          die Firma keine Haftung.
        </div>
        <div class="signature-fields">
          <div class="signature-field">Ort, Datum</div>
          <div class="signature-field">Unterschrift des Auftraggebers</div>
        </div>
      </section>
      
      <!-- Delivery Address -->
      <section class="delivery-address">
        <h3>Lieferadresse:</h3>
        <div class="delivery-zone">
          {{#if delivery_address}}
            {{#if delivery_address.company}}{{delivery_address.company}}<br>{{/if}}
            {{delivery_address.name}}<br>
            {{delivery_address.street}} {{delivery_address.house_number}}<br>
            {{#if delivery_address.line2}}{{delivery_address.line2}}<br>{{/if}}
            {{delivery_address.postal_code}} {{delivery_address.city}}
          {{else}}
            {{#if customer.company}}{{customer.company}}<br>{{/if}}
            {{customer.name}}<br>
            {{customer.address.street}} {{customer.address.house_number}}<br>
            {{#if customer.address.line2}}{{customer.address.line2}}<br>{{/if}}
            {{customer.address.postal_code}} {{customer.address.city}}
          {{/if}}
        </div>
        <div class="confirmation-statement">
          Hiermit bestätige ich den ordnungsgemäßen Zustand und Erhalt der bestellten Ware.
        </div>
        <div class="final-signature">Datum, Unterschrift</div>
      </section>
    </div>
    
    </div> <!-- End content-wrapper -->
    
    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-section left">
          <strong>{{company.name}}</strong>
          <p>{{company.address_line1}}</p>
          <p>{{company.postal_code}} {{company.city}}</p>
          {{#if company.phone}}<p>Mobil: {{company.phone}}</p>{{/if}}
          {{#if company.email}}<p>Email: {{company.email}}</p>{{/if}}
          {{#if company.website}}<p>Internet: {{company.website}}</p>{{/if}}
        </div>
        
        {{#if payment.iban}}
        <div class="footer-section center">
          <strong>Bankverbindung</strong>
          {{#if payment.bank_name}}<p>{{payment.bank_name}}</p>{{/if}}
          <p>IBAN: {{payment.iban}}</p>
          <p>BIC: {{payment.bic}}</p>
        </div>
        {{/if}}
        
        <div class="footer-section right">
          {{#if company.registration}}<p>Steuer-Nr.: {{company.registration}}</p>{{/if}}
          {{#if company.tax_id}}<p>USt-Ident-Nr.: {{company.tax_id}}</p>{{/if}}
        </div>
      </div>
    </footer>
  </div>
  
  <script>
    // Vereinfachte Pagination - CSS übernimmt Seitenumbrüche
    function setupPagination() {
      // CSS @page und print-Regeln übernehmen automatisch die Seitenumbrüche
      // Keine dynamische JavaScript-Manipulation mehr nötig
    }
    
    // Vereinfachte Seitennummerierung - CSS @page übernimmt die Darstellung
     function updatePageNumbers() {
       // CSS @page counter übernimmt automatisch die Seitennummerierung
       // Keine manuelle Berechnung mehr nötig
     }
    
    // Event Listeners
    document.addEventListener('DOMContentLoaded', function() {
      setupPagination();
      updatePageNumbers();
    });
    
    window.addEventListener('beforeprint', function() {
      setupPagination();
      updatePageNumbers();
    });
    
    window.addEventListener('resize', function() {
      setupPagination();
    });
  </script>
</body>
</html>