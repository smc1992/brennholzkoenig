<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Rechnung {{invoice.number}}</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Bebas+Neue&display=swap');
    
    @page {
      size: A4;
      margin: 0;
      
      @top-center {
        content: "";
      }
      
      @bottom-center {
        content: "";
      }
      
      @bottom-right {
        content: "";
      }
    }
    
    @media print {
      .no-print { display: none !important; }
      
      body {
        margin: 0;
        padding: 0;
        width: 210mm;
        height: 297mm;
      }
      
      .container {
        margin: 0;
        padding: 0;
        box-shadow: none;
        width: 210mm !important;
        max-width: 210mm !important;
        min-height: auto;
        transform: scale(0.92);
        transform-origin: top left;
      }
      
      .footer {
        position: fixed !important;
        bottom: 12mm !important;
        left: 15mm !important;
        right: 15mm !important;
        margin: 0 !important;
        padding: 8pt 4mm !important; /* horizontal padding match items-section */
        border-top: 1pt solid #ddd !important;
        background: white !important;
        z-index: 1000 !important;
        box-sizing: border-box !important;
        overflow: visible !important;
      }
      
      .footer-content {
        display: flex !important;
        justify-content: space-between !important;
        align-items: flex-start !important;
        flex-wrap: wrap !important;
        gap: 15pt !important;
        max-width: 180mm !important;
        margin: 0 auto !important;
        padding: 0 4mm !important; /* match items-section padding */
      }
      
      .footer-section {
        flex: 1 1 0 !important;
        min-width: 120pt !important;
        max-width: none !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
      }

      .footer-section.right {
        padding-right: 3mm !important;
        text-align: right !important;
        margin-right: 0 !important;
      }

      .footer-section.right p {
        white-space: normal !important;
        word-break: break-word !important;
        overflow: visible !important;
      }
      
      .content-wrapper {
        padding: 0 12mm 10mm 12mm !important;
        margin: 0 !important;
        position: relative;
        z-index: 1;
      }
      
      table {
        page-break-inside: avoid;
      }
      
      tr {
        page-break-inside: avoid;
      }
      
      .items-table thead {
        display: table-header-group;
      }
      
      .items-table tbody tr {
        page-break-inside: avoid;
        page-break-after: auto;
      }
      
      .totals-section {
        page-break-inside: avoid;
        page-break-before: auto;
      }
      
      .payment-terms {
        page-break-inside: avoid;
        page-break-before: auto;
      }
      
      .notes {
        page-break-inside: avoid;
        page-break-before: auto;
      }
      
      .page-break {
        page-break-before: always;
      }
      
      .page-break-avoid {
        page-break-inside: avoid;
      }
      
      /* Ensure header and footer appear on every page */
      .order-confirmation-page .header {
        display: none; /* Hide duplicate header on order confirmation page */
      }
      
      /* Ensure recipient section is positioned correctly in PDF */
      .recipient-section {
        margin-top: 0pt !important;
        margin-bottom: 25pt !important;
      }
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      font-size: 11pt;
      line-height: 1.5;
      color: #1A1A1A;
      margin: 0;
      padding: 0;
      background: white;
    }
    
    .container {
      width: 100%;
      max-width: 210mm;
      margin: 0 auto;
      background: white;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 10pt;
      line-height: 1.4;
      color: #333;
    }
    
    .content-wrapper {
      padding: 0;
      margin: 0;
      position: relative;
      z-index: 1;
    }
    
    /* Header */
    .header {
      background-color: #C53030;
      color: white;
      padding: 15pt 15mm;
      margin: 0;
      width: 100%;
      box-sizing: border-box;
      z-index: 10;
      display: flex;
      justify-content: space-between;
      align-items: center;
      overflow: hidden;
      min-height: 60pt;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
      position: relative;
    }
    
    .header::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 100pt;
      height: 100%;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M20,20 Q50,5 80,20 Q50,35 20,20" fill="%23ffffff" opacity="0.1"/></svg>') no-repeat center;
      background-size: contain;
    }
    
    .logo-section {
      flex: 0 0 auto;
      z-index: 2;
    }
    
    .logo {
      max-width: 120pt;
      max-height: 60pt;
      object-fit: contain;
    }
    
    .brand-name {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 24pt;
      font-weight: 400;
      letter-spacing: 1pt;
      margin: 0;
    }
    
    .brand-tagline {
      font-size: 9pt;
      opacity: 0.9;
      margin: 2pt 0 0 0;
      font-weight: 400;
    }
    
    .issuer-section {
      flex: 0 0 auto;
      text-align: right;
      font-size: 9pt;
      line-height: 1.4;
      z-index: 2;
    }
    
    .issuer-name {
      font-size: 13pt;
      font-weight: 600;
      margin-bottom: 6pt;
    }
    
    .issuer-address {
      margin-bottom: 6pt;
      opacity: 0.95;
    }
    
    .issuer-contact {
      font-size: 8pt;
      opacity: 0.9;
    }
    
    /* Top info two-column layout (sender/recipient left, details right) */
    .top-info {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 6pt;
      padding: 10mm 12mm 4mm 12mm;
      background: white;
      color: #1A1A1A;
      font-size: 9pt;
      align-items: start;
    }
    .top-left {
      display: flex;
      flex-direction: column;
      gap: 6pt;
    }
    .sender-line { font-size: 8pt; white-space: nowrap; color: #555; }
    .callout { margin-bottom: 4pt; }
    .callout .phone { font-weight: 800; font-size: 16pt; color: #C04020; }
    .callout .tagline { font-size: 9pt; color: #333; }
    .sender-line {
      color: #555;
      font-size: 8.5pt;
    }
    .recipient-block {
      line-height: 1.35;
      margin-top: 6pt; /* kleine Luft zwischen Absenderzeile und Empf√§nger */
    }
    .recipient-block .recipient-name {
      font-weight: 600;
      font-size: 10pt;
    }
    .top-right {
      text-align: left;
      font-size: 9pt;
    }
    .brand-logo { max-width: 70pt; max-height: 70pt; object-fit: contain; display: block; margin-left: auto; margin-bottom: 6pt; }
    .top-right .website {
      font-weight: 600;
      margin-bottom: 6pt;
      text-align: right;
    }
    .top-right .detail-row {
      margin: 2pt 0;
    }
    .top-right .detail-row .label { color: #555; }
    .top-right .detail-row .value { font-weight: 500; }
    
    /* Recipient (DIN 5008 konform) */
    .recipient-section {
      margin-bottom: 25pt;
      margin-top: 0pt;
    }
    
    .recipient {
      background: white;
      border: 1pt solid #ddd;
      border-left: 4pt solid #C04020;
      border-radius: 0 8pt 8pt 0;
      padding: 15pt 20pt;
      font-size: 11pt;
      line-height: 1.4;
      box-shadow: 0 2pt 8px rgba(192, 64, 32, 0.1);
    }
    
    .recipient-name {
      font-weight: 700;
      font-size: 12pt;
      color: #C04020;
      margin-bottom: 6pt;
    }
    
    /* Metadata */
    .metadata {
      margin-bottom: 25pt;
      background: #f8f9fa;
      border-radius: 12pt;
      padding: 20pt;
      border: 1pt solid #ddd;
    }
    
    .metadata-table {
      width: 100%;
      font-size: 10pt;
      border-collapse: collapse;
    }
    
    .metadata-table td {
      padding: 4pt 8pt;
      vertical-align: top;
    }
    
    .metadata-table .label {
      font-weight: 600;
      color: #666;
      width: 25%;
    }
    
    .metadata-table .value {
      width: 25%;
      font-weight: 500;
      color: #1A1A1A;
    }
    
    /* Invoice Title */
    .invoice-title {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 22pt;
      font-weight: 400;
      letter-spacing: 1.5pt;
      margin: 12pt 0 8pt 0;
      color: #C04020;
      text-transform: uppercase;
      position: relative;
      padding-bottom: 6pt;
    }
    
    .invoice-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60pt;
      height: 3pt;
      background: #C04020;
      border-radius: 2pt;
    }
    
    /* Items Table */
    .items-table {
      width: 100%;
      border-collapse: collapse;
      margin: 10pt 0;
      font-size: 9pt;
    }

    /* Zentrierte Sektionen und leichter Innenabstand */
    .items-section,
    .metadata,
    .payment-terms,
    .notes,
    .totals-section,
    .delivery-address,
    .order-confirmation,
    .order-confirmation-page,
    .recipient-section,
    .signature-row {
      max-width: 180mm;
      margin-left: auto;
      margin-right: auto;
    }

    .items-section {
      padding: 0 4mm;
    }

    /* Totals rechtsb√ºndig zur Tabelle ausrichten */
    .totals-section {
      padding: 0 4mm;
    }
    .totals-section > div {
      float: none !important;
      margin-left: auto;
      margin-right: 0;
      display: block;
    }
    
    .items-table th {
      background: #f5f5f5;
      color: #333;
      font-weight: 600;
      padding: 8pt 6pt;
      text-align: left;
      border: 1pt solid #ccc;
      font-size: 8pt;
    }
    
    .items-table td {
      padding: 6pt;
      border: 1pt solid #ccc;
      vertical-align: top;
      font-size: 8pt;
    }
    
    .items-table .pos {
      width: 8%;
      text-align: center;
    }
    
    .items-table .description {
      width: 35%;
    }
    
    .items-table .category {
      width: 15%;
      text-align: left;
    }

    .items-table .quantity {
      width: 10%;
      text-align: right;
    }
    
    .items-table .unit-price {
      width: 19%;
      text-align: right;
    }
    
    .items-table .total {
      width: 21%;
      text-align: right;
      font-weight: 600;
    }
    
    .items-table .number {
      font-family: 'Courier New', monospace;
    }
    
    /* Totals */
    .totals-section {
      display: block;
      margin-top: 20pt;
      margin-bottom: 18pt;
      max-width: 180mm;
      margin-left: auto;
      margin-right: auto;
      padding: 0 4mm; /* identisches Innenpad wie Items-Tabelle */
    }
    
    .totals {
      width: 280pt;
      border-radius: 12pt;
      overflow: hidden;
      box-shadow: 0 6pt 20pt rgba(192, 64, 32, 0.15);
      border: 1pt solid #ddd;
    }
    
    .totals-header {
      background: linear-gradient(135deg, #C04020 0%, #A03318 100%);
      color: white;
      padding: 15pt 20pt;
      font-weight: 700;
      font-size: 12pt;
      text-transform: uppercase;
      letter-spacing: 1pt;
      position: relative;
    }
    
    .totals-header::after {
      content: '';
      position: absolute;
      right: 20pt;
      top: 50%;
      transform: translateY(-50%);
      width: 16pt;
      height: 16pt;
      background-repeat: no-repeat;
      background-size: contain;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12 2c1.5 2 2.5 4.2 2.5 6.2 0 2.2-1.2 3.8-3.5 4.8 0.3-1.7-0.6-3.5-2.5-5.4-1.5 3.4-2.5 5.6-2.5 7.4 0 3.3 2.7 5 6.5 5 3.9 0 6.5-2.2 6.5-5.5 0-2.7-1.5-4.9-4.5-6.6 0.5 2.5-0.8 4.3-3 5.1 0.5-2.5-0.6-4.3-3-5.8C9.6 4.7 10.7 3.2 12 2z"/></svg>');
    }
    
    .totals-body {
      padding: 20pt;
      background: white;
    }
    
    .totals-table {
      width: 100%;
      font-size: 10pt;
    }
    
    .totals-table td {
      padding: 6pt 0;
    }
    
    .totals-table .label {
      text-align: left;
      font-weight: 500;
      color: #666;
    }
    
    .totals-table .amount {
      text-align: right;
      font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
      font-weight: 600;
      color: #1A1A1A;
    }
    
    .totals-table .total-row {
      border-top: 2pt solid #C04020;
      padding-top: 10pt;
      font-weight: 700;
      font-size: 13pt;
    }
    
    .totals-table .total-row td {
      padding-top: 10pt;
    }
    
    .totals-table .total-row .label {
      color: #C04020;
    }
    
    .totals-table .total-row .amount {
      color: #C04020;
      font-size: 14pt;
    }
    
    /* Payment Terms */
    .payment-terms {
      margin-bottom: 18pt;
      padding: 20pt;
      background: #f8f9fa;
      border: 1pt solid #ddd;
      border-left: 4pt solid #C04020;
      border-radius: 8pt;
      font-size: 10pt;
      box-shadow: 0 2pt 8pt rgba(192, 64, 32, 0.08);
    }
    
    .payment-terms h3 {
      margin: 0 0 10pt 0;
      font-size: 12pt;
      font-weight: 700;
      color: #C04020;
      display: flex;
      align-items: center;
    }
    
    .payment-terms h3::before {
      content: '';
      display: inline-block;
      width: 14pt;
      height: 14pt;
      margin-right: 8pt;
      background-repeat: no-repeat;
      background-size: contain;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23C04020"><rect x="2" y="5" width="20" height="14" rx="2"/><rect x="2" y="8" width="20" height="3" fill="white"/></svg>');
    }
    
    /* Order Confirmation Page */
    .order-confirmation-page {
      padding: 15mm 15mm;
    }
    
    .page-title {
      text-align: center;
      font-size: 22pt;
      font-weight: 700;
      color: #C04020;
      margin-bottom: 20pt;
      text-transform: uppercase;
      letter-spacing: 1pt;
    }
    
    /* Order Confirmation */
    .order-confirmation {
      margin-bottom: 16pt;
      padding: 18pt;
      background: #f8f9fa;
      border: 1pt solid #ddd;
      border-left: 4pt solid #C04020;
      border-radius: 6pt;
      font-size: 10pt;
      line-height: 1.4;
      box-shadow: 0 2pt 6pt rgba(192, 64, 32, 0.08);
    }
    
    .order-confirmation h3 {
      margin: 0 0 12pt 0;
      font-size: 12pt;
      font-weight: 700;
      color: #C04020;
      display: flex;
      align-items: center;
    }
    
    .order-confirmation h3::before {
      content: '';
      display: inline-block;
      width: 14pt;
      height: 14pt;
      margin-right: 8pt;
      background-repeat: no-repeat;
      background-size: contain;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%231A1A1A"><path d="M7 2h10a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z"/><path d="M9 6h6v2H9V6zm0 4h6v2H9v-2zm0 4h6v2H9v-2z"/></svg>');
    }
    
    .confirmation-text {
      margin-bottom: 18pt;
      line-height: 1.5;
      text-align: justify;
    }
    
    .signature-fields {
      display: flex;
      justify-content: space-between;
      margin-top: 25pt;
    }
    
    .signature-field {
      width: 45%;
      border-bottom: 1pt solid #333;
      padding-bottom: 3pt;
      text-align: center;
      font-size: 9pt;
      color: #666;
      min-height: 25pt;
    }

    /* Customer Delivery Notes */
    .customer-delivery-notes {
      margin-bottom: 14pt;
      padding: 14pt 18pt 22pt 18pt;
      background: #f8f9fa;
      border: 1pt solid #ddd;
      border-left: 4pt solid #C04020;
      border-radius: 6pt;
      font-size: 10pt;
      box-shadow: 0 2pt 6pt rgba(192, 64, 32, 0.08);
      page-break-inside: avoid;
      break-inside: avoid;
      display: block;
      min-height: auto;
    }
    .customer-delivery-notes h3 { margin: 0 0 8pt 0; font-size: 12pt; color: #C04020; }
    .customer-delivery-notes .note-text { line-height: 1.45; }
    .customer-delivery-notes .final-signature { display: block; width: 80%; margin-top: 12pt; }
    .customer-delivery-notes .signature-inline { margin-top: 10pt; }

    /* Separate signature row under customer notes */
    .signature-row {
      clear: both;
      margin-top: 10pt;
      padding: 0 4mm;
      page-break-inside: avoid;
      break-inside: avoid;
      position: relative;
      z-index: 2; /* ensure above any floated/positioned side content */
    }
    .signature-label {
      font-size: 9pt;
      color: #666;
      margin-bottom: 6pt;
      text-align: left;
    }
    .signature-line {
      display: block;
      width: 100%;
      border-bottom: 2pt solid #333;
      height: 18pt; /* field height */
      margin-top: 6pt;
      margin-bottom: 8pt;
      position: relative;
      z-index: 2;
    }

    /* Delivery Address */
    .delivery-address {
      margin: 14pt 0 12pt 0;
      padding: 0;
      background: none;
      border: none;
      border-left: none;
      border-radius: 0;
      font-size: 10pt;
      line-height: 1.4;
      box-shadow: none;
      page-break-inside: avoid;
      break-inside: avoid;
    }
    
    .delivery-address h3 {
      margin: 0 0 12pt 0;
      font-size: 12pt;
      font-weight: 700;
      color: #C04020;
      display: flex;
      align-items: center;
    }
    
    .delivery-address h3::before {
      content: '';
      display: inline-block;
      width: 14pt;
      height: 14pt;
      margin-right: 8pt;
      background-repeat: no-repeat;
      background-size: contain;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%231A1A1A"><path d="M3 6h11v8H3V6zm12 3h4l2 3v2h-6V9z"/><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/></svg>');
    }
    
    .delivery-zone {
      margin-top: 12pt;
      padding: 12pt;
      background: #fff;
      border: 1pt solid #ddd;
      border-radius: 4pt;
      min-height: 60pt;
      font-size: 11pt;
      line-height: 1.4;
    }
    
    .confirmation-statement {
      margin: 8pt 0 10pt 0;
      padding: 0;
      background: none;
      border: none;
      border-radius: 0;
      text-align: left;
      font-weight: 600;
      font-size: 10pt;
      line-height: 1.3;
    }
    
    .final-signature {
      margin-top: 6pt;
      border-bottom: 1pt solid #333;
      padding-bottom: 6pt;
      text-align: left;
      font-size: 9pt;
      color: #666;
      width: 70%;
      margin-left: 0;
      margin-right: 0;
      min-height: 20pt;
    }
    
    /* Notes */
    .notes {
      margin-bottom: 18pt;
      padding: 20pt;
      background: #f8f9fa;
      border: 1pt solid #ddd;
      border-left: 4pt solid #C04020;
      border-radius: 8pt;
      font-size: 10pt;
      line-height: 1.6;
      box-shadow: 0 2pt 8pt rgba(192, 64, 32, 0.08);
    }
    
    .notes h3 {
      margin: 0 0 10pt 0;
      font-size: 12pt;
      font-weight: 700;
      color: #C04020;
      display: flex;
      align-items: center;
    }
    
    .notes h3::before {
      content: '';
      display: inline-block;
      width: 14pt;
      height: 14pt;
      margin-right: 8pt;
      background-repeat: no-repeat;
      background-size: contain;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%231A1A1A"><path d="M4 4h12l4 4v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"/><path d="M8 12h8v2H8v-2zm0 4h6v2H8v-2z"/></svg>');
    }
    
    /* Footer */
    .footer {
      margin-top: 20pt !important;
      padding: 10pt 20pt !important;
      border-top: 1pt solid #ddd !important;
      font-size: 8pt !important;
      line-height: 1.3 !important;
      color: #666 !important;
      text-align: center !important;
      max-width: 100% !important;
      overflow: visible !important;
      width: 100% !important;
      box-sizing: border-box !important;
    }
    
    .footer-content {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      flex-wrap: wrap;
      gap: 15pt;
      max-width: 100%;
    }
    
    .footer-section {
      flex: 1;
      min-width: 120pt;
      max-width: 33%;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }
    
    .footer-section.left {
      text-align: left;
    }
    
    .footer-section.center {
      text-align: center;
    }
    
    .footer-section.right {
      text-align: right;
    }
    
    .footer-section strong {
      font-weight: 600;
      color: #333;
      display: block;
      margin-bottom: 2pt;
    }
    
    .footer-section p {
      margin: 0;
      line-height: 1.2;
      word-wrap: break-word;
    }
    
    /* Utilities */
    .text-right {
      text-align: right;
    }
    
    .text-center {
      text-align: center;
    }
    
    .font-mono {
      font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
    }
    
    .text-muted {
      color: #666;
    }
    
    .mb-0 {
      margin-bottom: 0;
    }
    
    .mt-0 {
      margin-top: 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header entfernt: roter Kopfbereich ausgeblendet, wei√üer Bereich r√ºckt nach oben -->
    
    <div class="content-wrapper">

    <!-- Top info: DIN sender+recipient left, details right -->
    <section class="top-info">
      <div class="top-left">
        {{#if company.phone}}
        <div class="callout">
          <div class="phone">üìû {{company.phone}}</div>
          <div class="tagline">Bestellung und Beratung t√§glich von 16.30 bis 20.00 Uhr</div>
        </div>
        {{/if}}
        <div class="sender-line">{{company.name}} ¬∑ {{company.address_line1}} ¬∑ {{company.postal_code}} {{company.city}}</div>
        <div class="recipient-block">
          {{#if delivery_address}}
            {{#if delivery_address.company}}{{delivery_address.company}}<br>{{/if}}
            <div class="recipient-name">{{delivery_address.name}}</div>
            {{delivery_address.street}} {{delivery_address.house_number}}<br>
            {{!-- Lieferhinweis nicht in Empf√§ngerzeile anzeigen --}}
            {{delivery_address.postal_code}} {{delivery_address.city}}
          {{else}}
            {{#if customer.company}}{{customer.company}}<br>{{/if}}
            <div class="recipient-name">{{customer.name}}</div>
            {{customer.address.street}} {{customer.address.house_number}}<br>
            {{!-- Lieferhinweis nicht in Empf√§ngerzeile anzeigen --}}
            {{customer.address.postal_code}} {{customer.address.city}}
          {{/if}}
        </div>
      </div>
      <div class="top-right">
        {{#if company.logo_url}}
          <img src="{{company.logo_url}}" alt="{{company.name}} Logo" class="brand-logo">
        {{/if}}
        {{#if company.website}}<div class="website">{{company.website}}</div>{{/if}}
        <div class="detail-row"><span class="label">Kundennummer:</span> <span class="value font-mono">{{#if customer.customer_number}}{{customer.customer_number}}{{else}}{{customer.number}}{{/if}}</span></div>
        {{#if customer.phone}}<div class="detail-row"><span class="label">Kundenrufnummer:</span> <span class="value">{{customer.phone}}</span></div>{{/if}}
        {{#if order.date}}<div class="detail-row"><span class="label">Bestellt am:</span> <span class="value">{{order.date}}</span></div>{{/if}}
        {{#if order.contact_method}}<div class="detail-row"><span class="label">Kontakt √ºber:</span> <span class="value">{{order.contact_method}}</span></div>{{/if}}
      </div>
    </section>
    
    <!-- Metadata entfernt: nur Zeile "Auftrag/Lieferschein/Rechnung Nr.:" bleibt oberhalb der Positionen -->
    
    <!-- Items Table (einfach, ohne Fortsetzungsseite) -->
    <section class="items-section">
      <h3 style="margin: 12pt 0 6pt 0; font-size: 11pt; color: #333;">Auftrag/Lieferschein/Rechnung Nr.:</h3>
      <table class="items-table">
        <thead>
          <tr>
            <th class="description">Sorte/Art</th>
            <th class="category">Kategorie</th>
            <th class="quantity">Menge</th>
            <th class="unit-price">Preis Brutto/SRM</th>
            <th class="total">Gesamt Brutto</th>
          </tr>
        </thead>
        <tbody>
          {{#each items}}
          <tr>
            <td class="description">{{this.name}}</td>
            <td class="category">{{#if this.category}}{{this.category}}{{else}}-{{/if}}</td>
            <td class="quantity number">{{formatNumber this.quantity}}</td>
            <td class="unit-price number">‚Ç¨{{formatCurrency this.unitPrice}}</td>
            <td class="total number">‚Ç¨{{formatCurrency this.totalPrice}}</td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    </section>
    
    <!-- Best√§tigungszeile wird in den Lieferhinweisen des Kunden integriert -->
    
    <!-- Totals -->
    <section class="totals-section">
      <div style="float: right; width: 200pt; margin-top: 25pt;">
        <table style="width: 100%; border-collapse: collapse; font-size: 9pt;">
          <tr>
            <td style="padding: 4pt; text-align: left;">Gesamt Netto:</td>
            <td style="padding: 4pt; text-align: right; font-weight: 600;">{{formatCurrency totals.subtotal}}</td>
          </tr>
          <tr>
            <td style="padding: 4pt; text-align: left;">zzgl. {{totals.tax_rate}}% MwSt.:</td>
            <td style="padding: 4pt; text-align: right;">{{formatCurrency totals.tax}}</td>
          </tr>
          <tr style="border-top: 2pt solid #333; font-weight: 600; font-size: 10pt;">
            <td style="padding: 6pt 4pt; text-align: left;">Gesamt Brutto</td>
            <td style="padding: 6pt 4pt; text-align: right;">{{formatCurrency totals.total}}</td>
          </tr>
        </table>
      </div>
      <div style="clear: both; margin-bottom: 15pt;"></div>
    </section>
    
    
    <!-- Payment Terms -->
    {{#if payment_terms}}
    <section class="payment-terms">
      <h3>Zahlungsbedingungen</h3>
      <p>{{payment_terms}}</p>

    </section>
    {{/if}}
    
    <!-- Notes -->
    {{#if notes}}
    <section class="notes">
      <h3>Hinweise</h3>
      <p>{{notes}}</p>
    </section>
    {{/if}}
    
    <!-- Auftragsbest√§tigung (auf derselben Seite) -->
    <section class="order-confirmation">
      <h3 style="margin-top: 8pt;">Auftragsbest√§tigung:</h3>
      <div class="confirmation-text">
        Ich erteile / Wir erteilen den Auftrag f√ºr die Brennholzlieferung 
        gem√§√ü obigem Angebot. Die AGBs und Lieferbedingung frei Bordsteinkante 
        habe ich gelesen und akzeptiert. F√ºr ausdr√ºcklich gew√ºnschte Lieferungen 
        auf das Grundst√ºck √ºbernimmt der Fahrer und die Firma keine Haftung.
      </div>
      <div class="signature-fields">
        <div class="signature-field">Ort, Datum</div>
        <div class="signature-field">Unterschrift des Auftraggebers</div>
      </div>
    </section>

    {{#if order.delivery_notes}}
    <section class="customer-delivery-notes">
      <h3>Lieferhinweise des Kunden:</h3>
      <div class="note-text">{{order.delivery_notes}}</div>
      <div class="confirmation-statement">Hiermit best√§tige ich den ordnungsgem√§√üen Zustand und Erhalt der bestellten Ware.</div>
      <div class="signature-inline">
        <div class="signature-label">Datum und Unterschrift</div>
        <div class="signature-line"></div>
      </div>
    </section>
    {{else}}
      {{#if delivery_address.line2}}
      <section class="customer-delivery-notes">
        <h3>Lieferhinweise des Kunden:</h3>
        <div class="note-text">{{delivery_address.line2}}</div>
        <div class="confirmation-statement">Hiermit best√§tige ich den ordnungsgem√§√üen Zustand und Erhalt der bestellten Ware.</div>
        <div class="signature-inline">
          <div class="signature-label">Datum und Unterschrift</div>
          <div class="signature-line"></div>
        </div>
      </section>
      {{else}}
        {{#if customer.address.line2}}
        <section class="customer-delivery-notes">
          <h3>Lieferhinweise des Kunden:</h3>
          <div class="note-text">{{customer.address.line2}}</div>
          <div class="confirmation-statement">Hiermit best√§tige ich den ordnungsgem√§√üen Zustand und Erhalt der bestellten Ware.</div>
          <div class="signature-inline">
            <div class="signature-label">Datum und Unterschrift</div>
            <div class="signature-line"></div>
          </div>
        </section>
        {{/if}}
      {{/if}}
    {{/if}}

    
    
    </div> <!-- End content-wrapper -->
    
    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        
        
        {{#if payment.iban}}
        <div class="footer-section center">
          <strong>Bankverbindung</strong>
          {{#if payment.bank_name}}<p>{{payment.bank_name}}</p>{{/if}}
          <p>IBAN: {{payment.iban}}</p>
          <p>BIC: {{payment.bic}}</p>
        </div>
        {{/if}}
        
        <div class="footer-section right">
          <strong>{{company.name}}</strong>
          <p>{{company.address_line1}}</p>
          <p>{{company.postal_code}} {{company.city}}</p>
          {{#if company.phone}}<p>Mobil: {{company.phone}}</p>{{/if}}
          {{#if company.email}}<p>Email: {{company.email}}</p>{{/if}}
          {{#if company.website}}<p>Internet: {{company.website}}</p>{{/if}}
          {{#if company.registration}}<p>Steuer-Nr.: {{company.registration}}</p>{{/if}}
          {{#if company.tax_id}}<p>USt-Ident-Nr.: {{company.tax_id}}</p>{{/if}}
        </div>
      </div>
    </footer>
  </div>
  
  <script>
    // Vereinfachte Pagination - CSS √ºbernimmt Seitenumbr√ºche
    function setupPagination() {
      // CSS @page und print-Regeln √ºbernehmen automatisch die Seitenumbr√ºche
      // Keine dynamische JavaScript-Manipulation mehr n√∂tig
    }
    
    // Vereinfachte Seitennummerierung - CSS @page √ºbernimmt die Darstellung
     function updatePageNumbers() {
       // CSS @page counter √ºbernimmt automatisch die Seitennummerierung
       // Keine manuelle Berechnung mehr n√∂tig
     }
    
    // Event Listeners
    document.addEventListener('DOMContentLoaded', function() {
      setupPagination();
      updatePageNumbers();
    });
    
    window.addEventListener('beforeprint', function() {
      setupPagination();
      updatePageNumbers();
    });
    
    window.addEventListener('resize', function() {
      setupPagination();
    });
  </script>
</body>
</html>
