-- E-Mail-Template fÃ¼r ausverkaufte Produkte
-- Dieses Template wird in der app_settings Tabelle mit setting_type 'email_template' gespeichert

INSERT INTO app_settings (setting_type, setting_key, setting_value, description, created_at, updated_at) VALUES
('email_template', 'out_of_stock', '{
  "template_key": "out_of_stock",
  "template_name": "Produkt ausverkauft",
  "template_type": "out_of_stock",
  "subject": "ðŸš¨ AUSVERKAUFT: {product_name} - Sofortige Nachbestellung erforderlich",
  "html_content": "<!DOCTYPE html>\\n<html>\\n<head>\\n    <meta charset=\\"utf-8\\">\\n    <meta name=\\"viewport\\" content=\\"width=device-width, initial-scale=1.0\\">\\n    <title>Produkt ausverkauft</title>\\n    <style>\\n        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f5f5f5; }\\n        .container { max-width: 600px; margin: 0 auto; background-color: white; }\\n        .header { background-color: #dc2626; color: white; padding: 20px; text-align: center; }\\n        .logo { font-size: 24px; font-weight: bold; }\\n        .content { padding: 30px; }\\n        .critical-alert { background-color: #fef2f2; padding: 20px; margin: 20px 0; border-radius: 8px; border: 2px solid #dc2626; }\\n        .stats-box { background-color: #f8fafc; padding: 15px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #6b7280; }\\n        .footer { background-color: #1A1A1A; color: white; padding: 20px; text-align: center; }\\n        .button { background-color: #dc2626; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; display: inline-block; margin: 10px 0; }\\n        .urgent { color: #dc2626; font-weight: bold; }\\n    </style>\\n</head>\\n<body>\\n    <div class=\\"container\\">\\n        <div class=\\"header\\">\\n            <div class=\\"logo\\">ðŸš¨ KRITISCHE WARNUNG</div>\\n            <p>Produkt ist vollstÃ¤ndig ausverkauft</p>\\n        </div>\\n        \\n        <div class=\\"content\\">\\n            <h2 class=\\"urgent\\">PRODUKT AUSVERKAUFT</h2>\\n            <p>Hallo Admin-Team,</p>\\n            <p><strong>DRINGEND:</strong> Ein Produkt ist vollstÃ¤ndig ausverkauft und steht nicht mehr fÃ¼r VerkÃ¤ufe zur VerfÃ¼gung.</p>\\n            \\n            <div class=\\"critical-alert\\">\\n                <h3>ðŸš¨ Ausverkauftes Produkt</h3>\\n                <p><strong>Produktname:</strong> {product_name}</p>\\n                <p><strong>Aktueller Bestand:</strong> <span class=\\"urgent\\">0 Einheiten</span></p>\\n                <p><strong>Mindestbestand:</strong> {minimum_stock} Einheiten</p>\\n                <p><strong>Ausverkauft seit:</strong> {out_of_stock_date}</p>\\n                <p><strong>Letzter Verkauf:</strong> {last_sale_date}</p>\\n            </div>\\n            \\n            <div class=\\"stats-box\\">\\n                <h4>ðŸ“Š Verkaufsstatistiken (letzte 30 Tage)</h4>\\n                <p><strong>Verkaufte Einheiten:</strong> {sales_last_30_days}</p>\\n                <p><strong>Durchschnittlicher Tagesumsatz:</strong> {avg_daily_sales}</p>\\n                <p><strong>Empfohlene Nachbestellung:</strong> <span class=\\"urgent\\\">{recommended_reorder} Einheiten</span></p>\\n            </div>\\n            \\n            <p><strong>SOFORTIGE MASSNAHMEN ERFORDERLICH:</strong></p>\\n            <ul>\\n                <li>âœ… Produkt ist automatisch als \\"nicht verfÃ¼gbar\\" markiert</li>\\n                <li>ðŸ”„ Nachbestellung beim Lieferanten veranlassen</li>\\n                <li>ðŸ“§ Kunden Ã¼ber LieferverzÃ¶gerungen informieren</li>\\n                <li>ðŸ›’ Alternative Produkte im Shop hervorheben</li>\\n            </ul>\\n            \\n            <a href=\\"{admin_inventory_url}\\" class=\\"button\\">Lager sofort verwalten</a>\\n            <a href=\\"{reorder_url}\\" class=\\"button\\">Nachbestellung veranlassen</a>\\n        </div>\\n        \\n        <div class=\\"footer\\">\\n            <p>BrennholzkÃ¶nig - Automatisches Lagerverwaltungssystem</p>\\n            <p>Diese kritische Warnung wurde automatisch generiert.</p>\\n        </div>\\n    </div>\\n</body>\\n</html>",
  "text_content": "ðŸš¨ KRITISCHE WARNUNG - PRODUKT AUSVERKAUFT\\n\\nHallo Admin-Team,\\n\\nDRINGEND: Ein Produkt ist vollstÃ¤ndig ausverkauft und steht nicht mehr fÃ¼r VerkÃ¤ufe zur VerfÃ¼gung.\\n\\nAusverkauftes Produkt:\\n- Produktname: {product_name}\\n- Aktueller Bestand: 0 Einheiten\\n- Mindestbestand: {minimum_stock} Einheiten\\n- Ausverkauft seit: {out_of_stock_date}\\n- Letzter Verkauf: {last_sale_date}\\n\\nVerkaufsstatistiken (letzte 30 Tage):\\n- Verkaufte Einheiten: {sales_last_30_days}\\n- Durchschnittlicher Tagesumsatz: {avg_daily_sales}\\n- Empfohlene Nachbestellung: {recommended_reorder} Einheiten\\n\\nSOFORTIGE MASSNAHMEN ERFORDERLICH:\\n- Produkt ist automatisch als \\"nicht verfÃ¼gbar\\" markiert\\n- Nachbestellung beim Lieferanten veranlassen\\n- Kunden Ã¼ber LieferverzÃ¶gerungen informieren\\n- Alternative Produkte im Shop hervorheben\\n\\nLager sofort verwalten: {admin_inventory_url}\\nNachbestellung veranlassen: {reorder_url}\\n\\nBrennholzkÃ¶nig - Automatisches Lagerverwaltungssystem\\nDiese kritische Warnung wurde automatisch generiert.",
  "variables": ["product_name", "minimum_stock", "out_of_stock_date", "last_sale_date", "sales_last_30_days", "avg_daily_sales", "recommended_reorder", "admin_inventory_url", "reorder_url"],
  "is_active": true,
  "triggers": {
    "out_of_stock": true
  },
  "description": "Kritische Warnung bei vollstÃ¤ndig ausverkauften Produkten"
}', 'Email template: Produkt ausverkauft', NOW(), NOW())
ON CONFLICT (setting_type, setting_key) DO UPDATE SET
  setting_value = EXCLUDED.setting_value,
  updated_at = NOW();